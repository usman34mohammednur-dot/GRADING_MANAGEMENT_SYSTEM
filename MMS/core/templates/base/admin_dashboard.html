{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f3f4f6;
      margin: 0;
      padding: 0 20px;
    }
    h1 {
      text-align: center;
      margin-top: 20px;
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-top: 30px;
    }
    .card {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
    }
    th {
      background-color: #2c3e50;
      color: white;
    }
    .search-box {
      margin-bottom: 10px;
    }
    .form-section {
      margin-top: 50px;
    }
    .form-section form {
      margin-top: 15px;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .form-section form input, select {
      padding: 8px;
      width: 100%;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background-color: #2c3e50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #1a252f;
    }
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
     .table-container {
        max-height: 200px;  /* Fixed height */
        overflow-y: auto;  /* Enable vertical scrolling */
        margin-bottom: 10px;
        border: 1px solid #ddd;
    }
    
    /* Optional: Add sticky header */
    table thead {
        position: sticky;
        top: 0;
        background-color: white;
        z-index: 10;
    }
    
    /* Style the scrollbar */
    .table-container::-webkit-scrollbar {
        width: 8px;
    }
    
    .table-container::-webkit-scrollbar-track {
        background: #f1f1f1;
    }
    
    .table-container::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }
    
    .table-container::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
    @media (max-width: 768px) {
      .dashboard-grid, .form-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <script>
    function filterTable(inputId, tableId) {
      const input = document.getElementById(inputId);
      const filter = input.value.toLowerCase();
      const table = document.getElementById(tableId);
      const rows = table.getElementsByTagName("tr");
      for (let i = 1; i < rows.length; i++) {
        const cells = rows[i].getElementsByTagName("td");
        let match = false;
        for (let j = 0; j < cells.length; j++) {
          if (cells[j].innerText.toLowerCase().includes(filter)) {
            match = true;
            break;
          }
        }
        rows[i].style.display = match ? "" : "none";
      }
    }
  </script>
</head>
<body>
  <h1>Admin Dashboard</h1>
  <h2>Welcome, {{request.user.username}}</h2>
  <a href="{% url 'core:logout' %}" style="color:#fff; background: #dc3545; text-decoration: none; margin:1rem 1rem 0rem; border: 0; border-radius: 5px; padding: 1rem;" >Logout</a>
  <a href="{% url 'core:register_admin' %}" style="color:#fff; background: #3586dcff; text-decoration: none; margin:1rem 1rem 0rem; border: 0; border-radius: 5px; padding: 1rem;" target="_blank">Register admin</a>
  <form action="{% url 'core:delete_me' request.user.pk %}" method="post" style="display:inline-flex;">
    {% csrf_token %}
     <input type="submit" value="Delete Account"  style="color:#fff; background: #dc3545; text-decoration: none; margin:1rem 1rem 0rem; border: 0; border-radius: 5px; padding: 1rem;" >
  </form>
 

 <div class="dashboard-grid">
    <!-- Student List -->
    <div class="card">
        <h2>Students List</h2>
        <input type="text" id="studentSearch" class="search-box" onkeyup="filterTable('studentSearch', 'studentTable')" placeholder="Search students...">
        <div class="table-container"> 
            <table id="studentTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Code</th>
                        <th>Grade</th>
                        <th>Homeroom</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td>{{ student.first_name }} {{ student.second_name }}</td>
                        <td>{{ student.code }}</td>
                        <td>{{ student.grade }}</td>
                        <td>{{ student.homeroom_teacher }}</td>
                        <td>
                            <a href="{% url 'core:edit_student' student.id %}" 
                               style="display: inline-block; padding: 4px 8px; margin: 0 4px; text-decoration: none; border-radius: 3px; font-size: 14px; background-color: #4CAF50; color: white; transition: all 0.2s ease;">
                                Edit
                            </a>
                            <a href="{% url 'core:delete_student' student.id %}" 
                               style="display: inline-block; padding: 4px 8px; margin: 0 4px; text-decoration: none; border-radius: 3px; font-size: 14px; background-color: #f44336; color: white; transition: all 0.2s ease;">
                                Delete
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Teacher List -->
    <div class="card">
        <h2>Teachers List</h2>
        <input type="text" id="teacherSearch" class="search-box" onkeyup="filterTable('teacherSearch', 'teacherTable')" placeholder="Search teachers...">
        <div class="table-container">  <!-- Scrollable container -->
            <table id="teacherTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Classroom</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for teacher in teachers %}
                    <tr>
                        <td>{{ teacher.user.first_name }} {{ teacher.user.last_name }}</td>
                        <td>{{ teacher.user.email }}</td>
                        <td>{{ teacher.class_room }}</td>
                        <td>
                            <a href="{% url "core:edit_teacher" teacher.pk %}" style="display: inline-block; padding: 4px 8px; margin: 0 4px; text-decoration: none; border-radius: 3px; font-size: 14px; background-color: #4CAF50; color: white; transition: all 0.2s ease;">Edit</a>
                            <a href="{% url "core:delete_teacher" teacher.pk %}" style="display: inline-block; padding: 4px 8px; margin: 0 4px; text-decoration: none; border-radius: 3px; font-size: 14px; background-color: #f44336; color: white; transition: all 0.2s ease;">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

  <!-- Add Forms -->
  <div class="form-section">
    <h2 style="text-align:center;">Add Student and Teacher</h2>
    <div class="form-grid">

      <!-- Add Student -->
      <div>
        <h3>Add Student</h3>
        <form method="POST" >
          {% csrf_token %}
          {{ student_form.as_p }}
          <button type="submit" name="submit_student">Add Student</button>
        </form>
      </div>

      <!-- Add Teacher -->
      <div>
        <h3>Add Teacher</h3>
        <form method="POST" >
          {% csrf_token %}
          {{ teacher_form.as_p }}
          <button type="submit" name="submit_teacher">Add Teacher</button>
        </form>
      </div>

    </div>
  </div>
</body>
</html>
